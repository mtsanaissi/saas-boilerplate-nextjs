{
  "$schema": "./tasks.schema.json",
  "version": 1,
  "tasks": [
    {
      "id": "T-021",
      "title": "Testing + CI setup",
      "description": "Introduce unit/integration tests and a CI workflow for lint, typecheck, and tests.",
      "status": "pending",
      "createdAt": "2025-12-30",
      "completedAt": null,
      "acceptanceCriteria": [
        {
          "text": "Test runner configured with at least a smoke test for auth + billing flows",
          "done": false
        },
        {
          "text": "CI workflow runs lint, typecheck, and tests on pull requests",
          "done": false
        },
        {
          "text": "README documents how to run tests locally",
          "done": false
        }
      ]
    },
    {
      "id": "T-001",
      "title": "Localize user-facing errors via error codes",
      "description": "Replace direct decodeURIComponent/error-string rendering with error-code to t(\"errors.*\") mapping so all user-visible messages are fully localizable.",
      "status": "done",
      "createdAt": "2025-12-03",
      "completedAt": "2025-12-29",
      "acceptanceCriteria": [
        {
          "text": "UI never renders raw provider error strings to users",
          "done": true
        },
        {
          "text": "Errors map from stable error codes to `t(\"errors.*\")` keys",
          "done": true
        },
        {
          "text": "Unknown errors have a localized fallback message",
          "done": true
        }
      ]
    },
    {
      "id": "T-002",
      "title": "Forms + alerts accessibility pass",
      "description": "Enhance form and alert accessibility with aria-invalid, aria-describedby, role=alert/status, aria-live regions, and clear button vs link semantics.",
      "status": "done",
      "createdAt": "2025-12-03",
      "completedAt": "2025-12-29",
      "acceptanceCriteria": [
        {
          "text": "Invalid fields set `aria-invalid` and link errors via `aria-describedby`",
          "done": true
        },
        {
          "text": "Alerts use appropriate roles (`alert`/`status`) and `aria-live` where needed",
          "done": true
        },
        {
          "text": "Button vs link semantics match behavior (no fake links/buttons)",
          "done": true
        }
      ]
    },
    {
      "id": "T-003",
      "title": "WCAG focus/contrast + theme tokens",
      "description": "Improve focus indicators, color contrast, and Tailwind/DaisyUI theme tokens to meet WCAG AA, including dark mode and prefers-reduced-motion handling.",
      "status": "done",
      "createdAt": "2025-12-03",
      "completedAt": "2025-12-29",
      "acceptanceCriteria": [
        {
          "text": "Visible focus styles for all interactive elements (keyboard)",
          "done": true
        },
        {
          "text": "Theme tokens support light/dark and meet contrast targets where applicable",
          "done": true
        },
        {
          "text": "Motion respects `prefers-reduced-motion` for relevant animations/transitions",
          "done": true
        }
      ]
    },
    {
      "id": "T-004",
      "title": "Accessibility landmarks + skip link + headings",
      "description": "Update layout and pages for accessibility landmarks, including header/nav/main/footer roles, a skip-to-content link, and consistent heading hierarchy.",
      "status": "done",
      "createdAt": "2025-12-03",
      "completedAt": "2025-12-29",
      "acceptanceCriteria": [
        {
          "text": "Pages include clear landmarks (`header`, `nav`, `main`, `footer`)",
          "done": true
        },
        {
          "text": "A skip-to-content link exists and works with keyboard navigation",
          "done": true
        },
        {
          "text": "Heading hierarchy is consistent (single `h1`, no skipped levels)",
          "done": true
        }
      ]
    },
    {
      "id": "T-008",
      "title": "Introduce typed i18n with /:locale routing",
      "description": "Introduce an i18n library with /:locale routing and a typed message catalog, and move existing text (home hero, auth, plans, alerts) into locale message files.",
      "status": "done",
      "createdAt": "2025-12-03",
      "completedAt": "2025-12-19",
      "acceptanceCriteria": [
        {
          "text": "Routes support `/:locale` with a defined default locale",
          "done": true
        },
        {
          "text": "Message catalog is typed and used across app UI",
          "done": true
        },
        {
          "text": "Existing user-facing text migrated to locale message files",
          "done": true
        }
      ]
    },
    {
      "id": "T-009",
      "title": "Add placeholder pages to validate UX tasks",
      "description": "Create a few simple placeholder pages/components (no real content) that exercise accessibility, focus/contrast, forms/alerts, and error handling so changes from the remaining tasks can be tested and validated in-app.",
      "status": "done",
      "createdAt": "2025-12-29",
      "completedAt": "2025-12-29",
      "acceptanceCriteria": [
        {
          "text": "At least 2â€“3 placeholder pages exist to exercise forms, alerts, and error states",
          "done": true
        },
        {
          "text": "Pages are reachable via an obvious navigation entry (e.g., a dev-only link)",
          "done": true
        },
        {
          "text": "Pages include representative UI elements to validate focus styles and contrast",
          "done": true
        }
      ]
    },
    {
      "id": "T-010",
      "title": "Create minimal Supabase billing schema (single-user)",
      "description": "Add migrations for core billing tables and RLS policies so subscription state can be stored and read for single-user accounts.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-30",
      "acceptanceCriteria": [
        {
          "text": "Tables exist for profiles, billing_customers, billing_subscriptions, and stripe_events",
          "done": true
        },
        {
          "text": "RLS allows users to read their own billing data but restricts writes to service role only",
          "done": true
        },
        {
          "text": "Schema includes indexes/constraints for unique Stripe IDs and event deduplication",
          "done": true
        }
      ]
    },
    {
      "id": "T-011",
      "title": "Persist Stripe webhook events for subscription state",
      "description": "Extend the Stripe webhook handler to upsert subscription state for a single-user account and guard against duplicate processing.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-30",
      "acceptanceCriteria": [
        {
          "text": "Webhook verifies signatures in production and supports a safe local dev mode",
          "done": true
        },
        {
          "text": "Subscription state is upserted by user (status, price, period end, cancel-at-period-end)",
          "done": true
        },
        {
          "text": "Idempotency is enforced using Stripe event IDs",
          "done": true
        }
      ]
    },
    {
      "id": "T-012",
      "title": "Local Stripe mock + webhook dev setup",
      "description": "Add a local Stripe emulator workflow (stripe-mock or localstripe) with env toggles and README guidance so subscriptions + webhooks can be exercised without a real Stripe account.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-30",
      "acceptanceCriteria": [
        {
          "text": "Local mock instructions exist (how to start, which env vars to set, and any limitations vs real Stripe)",
          "done": true
        },
        {
          "text": "App can run in mock mode without real Stripe keys (dummy keys accepted)",
          "done": true
        },
        {
          "text": "Webhook flow can be triggered locally (documented example or helper route/script)",
          "done": true
        }
      ]
    },
    {
      "id": "T-013",
      "title": "Account recovery + verification flows",
      "description": "Add password reset, email verification/resend, and magic-link sign-in flows with localized UI and secure server actions.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-30",
      "acceptanceCriteria": [
        {
          "text": "Password reset request + confirm pages exist with Supabase email flow wired up",
          "done": true
        },
        {
          "text": "Email verification/resend flow is available after registration",
          "done": true
        },
        {
          "text": "All messages use i18n keys and server actions return localized error codes",
          "done": true
        }
      ]
    },
    {
      "id": "T-014",
      "title": "User profile settings",
      "description": "Create a profile/settings area that lets users update profile fields and locale preferences stored in `profiles`.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-30",
      "acceptanceCriteria": [
        {
          "text": "Settings page allows editing display name, avatar URL, and locale with validation",
          "done": true
        },
        {
          "text": "Profile updates use Supabase RLS-safe update paths and refresh in the UI",
          "done": true
        },
        {
          "text": "Dashboard reflects profile data (name + current locale) instead of placeholders",
          "done": true
        }
      ]
    },
    {
      "id": "T-015",
      "title": "Authorization + feature gating",
      "description": "Introduce centralized authorization helpers and server-side checks for protected routes and plan-based feature access (single-user, no orgs).",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-30",
      "acceptanceCriteria": [
        {
          "text": "Reusable auth guard utilities exist for RSCs, server actions, and API routes",
          "done": true
        },
        {
          "text": "Plan/feature checks are enforced server-side (not just in UI)",
          "done": true
        },
        {
          "text": "Denied access yields localized error UI or redirect paths",
          "done": true
        }
      ]
    },
    {
      "id": "T-016",
      "title": "Usage tracking + credits foundation",
      "description": "Add schema + server utilities to record usage events and enforce per-plan limits or credits.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-30",
      "acceptanceCriteria": [
        {
          "text": "Database tables exist for usage events and balances (per user)",
          "done": true
        },
        {
          "text": "Server utilities record usage and check remaining allowance/credits",
          "done": true
        },
        {
          "text": "Limit exhaustion returns localized errors and blocks new usage",
          "done": true
        }
      ]
    },
    {
      "id": "T-017",
      "title": "Rate limiting + abuse protections",
      "description": "Add per-user and per-IP rate limiting for auth and API endpoints with clear error handling.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-31",
      "acceptanceCriteria": [
        {
          "text": "Rate limiting applies to auth and critical API routes",
          "done": true
        },
        {
          "text": "Limits are configurable via env or config, with sensible defaults",
          "done": true
        },
        {
          "text": "Throttled responses return localized user-facing messages",
          "done": true
        }
      ]
    },
    {
      "id": "T-018",
      "title": "Billing management + plan status UI",
      "description": "Integrate Stripe Customer Portal and reflect live subscription status in the dashboard and settings.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-31",
      "acceptanceCriteria": [
        {
          "text": "Customer Portal link/button works for authenticated users",
          "done": true
        },
        {
          "text": "Dashboard shows current plan, status, and renewal date from billing tables",
          "done": true
        },
        {
          "text": "Upgrade/downgrade/cancel flows update UI after webhook sync",
          "done": true
        }
      ]
    },
    {
      "id": "T-019",
      "title": "Observability baseline",
      "description": "Add structured logging, error monitoring hooks, and minimal product analytics with environment toggles.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-31",
      "acceptanceCriteria": [
        {
          "text": "Server logs are structured and include request correlation IDs",
          "done": true
        },
        {
          "text": "Unhandled errors report to a configured monitoring provider",
          "done": true
        },
        {
          "text": "Basic analytics event tracking is available with opt-out toggle",
          "done": true
        }
      ]
    },
    {
      "id": "T-020",
      "title": "Security + compliance essentials",
      "description": "Add audit logging, session/device management, and legal/consent pages appropriate for SaaS.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-31",
      "acceptanceCriteria": [
        {
          "text": "Audit log table exists with server helpers to append security-relevant events",
          "done": true
        },
        {
          "text": "Users can view active sessions/devices and revoke sessions",
          "done": true
        },
        {
          "text": "Privacy Policy + Terms pages exist and consent settings are respected",
          "done": true
        }
      ]
    },
    {
      "id": "T-022",
      "title": "Usage UI summary card",
      "description": "Add a dashboard/settings UI surface that shows current period usage, remaining credits, and reset date.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-30",
      "acceptanceCriteria": [
        {
          "text": "Dashboard shows credits used/remaining for the current billing period",
          "done": true
        },
        {
          "text": "UI uses localized labels and formats dates consistently",
          "done": true
        },
        {
          "text": "Free vs paid plan messaging is clear (limit or unlimited if applicable)",
          "done": true
        }
      ]
    },
    {
      "id": "T-023",
      "title": "Usage details page",
      "description": "Create a dedicated usage page listing recent usage events and credits balance history.",
      "status": "done",
      "createdAt": "2025-12-30",
      "completedAt": "2025-12-30",
      "acceptanceCriteria": [
        {
          "text": "Usage page lists recent events with feature name, amount, and timestamp",
          "done": true
        },
        {
          "text": "Balance section shows current period totals and reset date",
          "done": true
        },
        {
          "text": "Page is gated to authenticated users and handles empty states",
          "done": true
        }
      ]
    },
    {
      "id": "T-024",
      "title": "Logging levels + env switch",
      "description": "Add debug-level logging support with an environment-configurable log level that gates verbose output.",
      "status": "done",
      "createdAt": "2025-12-31",
      "completedAt": "2025-12-31",
      "acceptanceCriteria": [
        {
          "text": "Logger supports debug/info/warn/error levels with a single log-level env switch",
          "done": true
        },
        {
          "text": "Debug logs are suppressed unless LOG_LEVEL=debug is set",
          "done": true
        },
        {
          "text": "README or AGENTS.md documents logging usage and env control",
          "done": true
        }
      ]
    }
  ]
}
